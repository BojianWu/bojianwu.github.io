<!doctype html>
<html>
<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="chrome=1">
	<title>Bojian Wu</title>

	<link rel="stylesheet" href="../../stylesheets/styles.css">
	<link rel="stylesheet" href="../../stylesheets/github-light.css">
	<meta name="viewport" content="width=device-width">
	
	<style>
		td,th {text-align:center}
		li {text-align:justify}
	</style>
</head>

<body>
	<div class="wrapper">
		<header>
			<h1>Bojian Wu</h1>
			<h4>ustcbjwu [AT] gmail.com<br />Chinese Academy of Sciences (CAS)</h4>
			<p><a href='../index.html'>Google Summer of Code(GSOC 2016) Blog</a></p>
			<p><a href='../daily/index.html'>Daily and Weekly Update</p>
			<p><a href='../bonding/index.html'>Bonding Period</p>
			<p><a href='../week_1/index.html'>Week 1</p>
			<p><a href='../week_2/index.html'>Week 2</p>
			<p><a href='../week_3/index.html'>Week 3</p>
			<p><a href='index.html'>Week 4</p>
		</header>
		
		<section>
			<h2><a id="week_4" class="anchor" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Week 4</h2>

			<font color='red'>
			
			<h3><font color='red'>[Texts marked with red are recent works, and I will update it frequently.]</font></h3>
						
			<h3>Practical Ray Tracing of Trimmed NURBS Surface[<a href="https://www.cs.utah.edu/~shirley/papers/raynurbs.pdf">download</a>]</h3>
			<p>In BRL-CAD, they use algorithms mentioned in this paper to do ray tracing of trimmed NURBS surface, actually in <i>brep.cpp</i>, functions whose name starts with '<i>utah_</i>' is an implementation of the algorithms proposed in this paper.</p>
			
			<p>Here I will give a brief introduction of it as follows.</p>
			
			<p>Generally speaking, it proposes a practical method suitable to implementation in general ray tracing programs. Besides, it also supports the direct use of untessellated trimmed NURBS surfaces. The key idea is outlined as follows(taken from the paper).</p>
			
			<img src='alg_intro.png' />
			
			<p>The simplified pipeline for computing ray-NURBS intersections usually has three main components: flattening, generating the BVH(Bounding Volume Hierarchy) and root finding.</p>
			
			<table>
				<li><b>Flattening: </b>Refining/Subdividing the control mesh so that each span(bounded by parameters in two direction defined by u and v) meets some flatness criteria. It is used to make sure that the initial guess of intersection point would be more close to the real solution. That is to say, we only need to do the guess in the patch defined by the span but not the whole mesh. The related two approaches are refinement of knot vector and adaptive subdivision. Usually, subdivision based methods will increase memory use which can be detrimental to runtime efficiency. So this paper discuss refinement based method which is proved to be more effcient.</li>
				<br />
				<li><b>Generating the BVH: </b>The BVH is represented as a tree structure whose root and internal nodes will contain simple primitives that buond portions of the underlying surface. The leaves of the tree are special objects which are used to provide an initial guess for later computation. Usually, we use AABBs as the primitives because they can be very flat and tightly arranged compared with others.</li>
				<br />
				<li><b>Root finding: </b>For efficient computation of ray-NURBS intersection, we employ Newton iteration to solve the problem. After getting the initial guess of intersection point, we use gradient descent method to optimize the result gradually.</li>
			</table>
			
			<p>By the way, in order to accelerate the ray-NURBS intersection test and enable precise computation, we can also partition the ray into several pieces and use bounding box of each ray partition to do intersection test with bounding box of each node of BVH. By doing this, we can improve the precision of initial guess of intersection point.</p>
			
			<h3>Current status of NURBS ray tracing</h3>
			
			<p>In order to figure out current progress of NURBS ray tracing, I design a B-rep model and test it with ray tracing, here are some results presented below. Here, the model is not a closed mesh, as you can see, it misses a piece of surface. Actually, it is what we really need.</p>
			
			<p><b>[I will post more detailed analysis later...]</b></p>
			
			<table border='1'>
				<tr>
					<th>B-rep Model</th>
					<th>Shot along X axis</th>
					<th>Shot along Y axis</th>
					<th>Shot along Z axis</th>
				</tr>
				<tr>
					<td><a href="brep_model.png"><img src="brep_model.png" /></a></td>
					<td><a href="shot_x_axis.png"><img src="shot_x_axis.png" /></a></td>
					<td><a href="shot_y_axis.png"><img src="shot_y_axis.png" /></a></td>
					<td><a href="shot_z_axis.png"><img src="shot_z_axis.png" /></a></td>
				</tr>
			</table>
			</p>
			
			</font>

		</section>
	</div>
</body>
</html>