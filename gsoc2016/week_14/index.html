<!doctype html>
<html>
<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="chrome=1">
	<title>Bojian Wu</title>

	<link rel="stylesheet" href="../../stylesheets/styles.css">
	<link rel="stylesheet" href="../../stylesheets/github-light.css">
	<meta name="viewport" content="width=device-width">

	<style>
		td,th {text-align:center}
		li {text-align:justify}
	</style>
</head>

<body>
	<div class="wrapper">
		<header>
			<h1>Bojian Wu</h1>
			<h4>ustcbjwu [AT] gmail.com<br />Chinese Academy of Sciences (CAS)</h4>
			<p><a href='../index.html'>Google Summer of Code(GSOC 2016) Blog</a></p>
			<p><a href='../daily/index.html'>Daily and Weekly Update</a></p>
			<p><a href='../bonding/index.html'>Bonding Period</a></p>
			<p><a href='../week_1/index.html'>Week 1</a></p>
			<p><a href='../week_2/index.html'>Week 2</a></p>
			<p><a href='../week_3/index.html'>Week 3</a></p>
			<p><a href='../week_4/index.html'>Week 4</a></p>
			<p><a href='../week_5/index.html'>Week 5</a></p>
			<p><a href='../week_6/index.html'>Week 6</a></p>
			<p><a href='../week_7/index.html'>Week 7</a></p>
			<p><a href='../week_8/index.html'>Week 8</a></p>
			<p><a href='../week_9_10_11/index.html'>Week 9/10/11</a></p>
			<p><a href='../week_12/index.html'>Week 12</a></p>
			<p><a href='../week_13/index.html'>Week 13</a></p>
			<p><a href='index.html'>Week 14</a></p>
		</header>

		<section>
			<h2><a id="week_14" class="anchor" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Week 14</h2>

			<!-- A short summary of what I have finished -->
			
			<h3>Summary of What I have done</h3>			
			<p>Please refer to the attached files for more details[<a href='gsoc2016-brlcad-submit-boj.rar'>Download</a>]. These files are the patches for 'Plate Mode NURBS raytracing' project 
supported by BRL-CAD in Google Summer of Code 2016. Here is a brief description.</p>

			<h4>(1) obj-g_memory_leak.patch</h4>
			<p>When using 'obj-g' to transform '*.obj' 3D model to BRL-CAD built-in '*.g' format, it will report memory leak before(please refer
to the link below for more details). It is fixed by disabling some default grouping information and content.[<a href='http://paste.ubuntu.com/16280918/'>Link</a>]</p>
    
			<h4>(2) plate-mode.patch</h4>
			<p>Almost all the changes are included in this file. For plate mode B-rep, the first thing is about how to integrate *thickness* value 
into BRL-CAD built-in data structure designed for representing B-rep model, actually, it uses openNURBS API for this purpose recently. 
Based on this, I have following changes to the original code.</h4>
			<p>
			<li><b>import and export of plate mode B-rep</b></li>
			<p>In order to be compatible with old format B-rep model, I have a flag indicating what type of the imported B-rep model is including 
plate-mode B-rep, normal-mode B-rep and old format. Please refer to rt_brep_import5()/rt_brep_export5() for more details.</p>

			<li><b>raytracing of plate mode B-rep</b></li>
			<p>In my implementation, I only consider to add *thickness* value to non-solid models cause a solid model already has its own volume. When
doing ray-tracing, compared with BoT, for plate-mode models, I center the original hit point and offset it along the ray direction/reverse 
ray direction with half of thickness value to generate two hit points.</p>
			<p>But differently, the BoT supports two modes for plate mode: *plate* and *plate nocos', the former one considers oblique angle of 
the ray while the latter one does not. For B-rep currently, I only mimic the latter one, it may cause some numerical problems and need 
to be verified later. Please refer to rt_brep_shot() for more details.</p>

			<li><b>raytracing of NURB surface</b></li>
			<p>If the surface is revolution surface like (hemi)sphere, generated by revolving a reference curve around an fixed axis, usually, the end
points on the curve are singular points, previously in BRL-CAD, it can not compute the normals at these points correctly. I replace the
old function with another openNURBS built-in routine to evaluate the normals, it works now. Please refer to utah_newton_solver() for more
details.</p>

			<li><b>hit points pruning rules</b></li>
			<p>Besides, I also change some rules used in pruning the NEAR_MISS/NEAR_HIT/CRACK_HIT hit points. Please refer to rt_brep_shot() for more
details.</p>
			</p>

			<h4>(3) brep_brep.cpp</h4>
			<p>This is a tool designed for transforming old B-rep representation into new format, to be more specifically, integrating face *thickness*
and turing the B-rep into plate mode.</p>

			<h4>(4) brep_surf.cpp</h4>
			<p>This is a tool designed for generating a piece of B-rep surface with *thickness* given by user. It is used for testing raytracing of
plate mode B-rep surface.</p>

			<h4>(5) brep_plane_trimmed.cpp/brep_surf_trimmed.cpp</h4>
			<p>These are tools designed for generating trimmed surface used for testing raytracing of plate mode B-rep surface.</p>

			<!-- Future work -->
			
			<h3>Future work</h3>

			<h4>(1) numerical analysis of plate mode B-rep raytracing</h4>
			<p>By assigning a *thickness* value to each surface, it now can have its own volume, so a numerical analysis to evalute the volume is 
necessary, the tool used for this purpose are 'nirt' and 'gqa'. Now, I have already used 'nirt' to shoot single ray for testing, it can give
me satisfactory results with correct hit points and hit distance. But, unfortunately, with 'gqa' test, it can not generate the right result
when computing volume of the surface compared with BoT with same configurations of the surface.<p>

			<h4>(2) interactive commands</h4>
			<p>As we can see, for BoT, we have lots of interactive commands used in MGED to control the configurations of the surface, maybe the next
step is to design or modify some commands to enable more utilizations.</p>

		</section>
	</div>
</body>
</html>
